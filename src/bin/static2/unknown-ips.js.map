{
  "version": 3,
  "sources": ["../src/helpers/scaling.js", "../src/helpers/builders.js", "../src/unknown-ips.js"],
  "sourcesContent": ["export function scaleNumber(n, fixed=2) {\n    if (n > 1000000000000) {\n        return (n / 1000000000000).toFixed(fixed) + \"T\";\n    } else if (n > 1000000000) {\n        return (n / 1000000000).toFixed(fixed) + \"G\";\n    } else if (n > 1000000) {\n        return (n / 1000000).toFixed(fixed) + \"M\";\n    } else if (n > 1000) {\n        return (n / 1000).toFixed(fixed) + \"K\";\n    }\n    return n;\n}\n\nexport function scaleNanos(n, precision=2) {\n    if (n === 0) return \"-\";\n    if (n > 60000000000) {\n        return (n / 60000000000).toFixed(precision) + \"m\";\n    }else if (n > 1000000000) {\n        return (n / 1000000000).toFixed(precision) + \"s\";\n    } else if (n > 1000000) {\n        return (n / 1000000).toFixed(precision) + \"ms\";\n    } else if (n > 1000) {\n        return (n / 1000).toFixed(precision) + \"\u00B5s\";\n    }\n    return n + \"ns\";\n}\n\nexport function colorRamp(n) {\n    if (n <= 100) {\n        return \"#aaffaa\";\n    } else if (n <= 150) {\n        return \"goldenrod\";\n    } else {\n        return \"#ffaaaa\";\n    }\n}\n\nexport function rttCircleSpan(rtt) {\n    let span = document.createElement(\"span\");\n    span.style.color = colorRamp(rtt);\n    span.innerText = \"\u2B24\";\n    return span;\n}\n\nexport function lerpGreenToRedViaOrange(value, max) {\n    let r = 0;\n    let g = 0;\n    let b = 0;\n    if (value < max / 2) {\n        r = 255;\n        g = Math.floor(255 * value / (max / 2));\n    } else {\n        r = Math.floor(255 * (max - value) / (max / 2));\n        g = 255;\n    }\n    return `rgb(${r}, ${g}, ${b})`;\n}\n\nexport function formatThroughput(throughput, limitInMbps) {\n    let limitBits = limitInMbps * 1000 * 1000;\n    let percent = 0;\n    if (limitBits > 0) {\n        percent = (throughput / limitBits) * 100;\n    }\n    let color = lerpGreenToRedViaOrange(100-percent, 100);\n    let blob = \"<span class='muted' style='color: \" + color + \"'>\u25A0</span>\";\n    blob += \"<span>\" + scaleNumber(throughput, 1) + \"bps</span>\";\n    return blob;\n}\n\nexport function formatRtt(rtt) {\n    if (rtt === undefined || rtt === null || rtt.nanoseconds === 0) {\n        return \"-\";\n    }\n    const limit = 200;\n    let percent = 0;\n    if (limit > 0) {\n        percent = (rtt / limit) * 100;\n    }\n    let color = lerpGreenToRedViaOrange(100-percent, 100);\n    let blob = \"<span class='muted' style='color: \" + color + \"'>\u25A0</span>\";\n    blob += \"<span>\" + parseFloat(rtt).toFixed(0) + \"ms</span>\";\n    return blob;\n}\n\nexport function formatRetransmit(retransmits) {\n    let percent = Math.min(100, retransmits) / 100;\n    let color = lerpColor([0, 255, 0], [255, 0, 0], percent);\n    return \"<span class='muted' style='color: \" + color + \"'>\u25A0</span>\" + retransmits + \"</span>\";\n}\n\nexport function formatCakeStat(n) {\n    let percent = Math.min(100, n) / 100;\n    let color = lerpColor([128, 128, 0], [255, 255, 255], percent);\n    let html = \"<span class='muted' class='retransmits' style='color: \" + color + \"'>\";\n    html += n;\n    html += \"</span>\";\n    return html;\n}\n\nexport function lerpColor(color1, color2, weight) {\n    var r = Math.round(color1[0] + (color2[0] - color1[0]) * weight);\n    var g = Math.round(color1[1] + (color2[1] - color1[1]) * weight);\n    var b = Math.round(color1[2] + (color2[2] - color1[2]) * weight);\n    return `rgb(${r}, ${g}, ${b})`;\n}\n\nexport function formatPercent(percent, digits=0) {\n    let color = lerpGreenToRedViaOrange(100-Math.min(100,percent), 100);\n    return \"<span class='muted' style='color: \" + color + \"'>\" + percent.toFixed(digits) + \"%</span>\";\n}\n\nexport function rttNanosAsSpan(rttNanos, precision=0) {\n    let rttInMs = Math.min(200, rttNanos / 1000000);\n    let color = lerpGreenToRedViaOrange(200 - rttInMs, 200);\n    let html = \"<span class='muted' style='color: \" + color + \"'>\u25A0</span> \" + scaleNanos(rttNanos, precision);\n    return html;\n}", "import {formatRetransmit, formatRtt, formatThroughput, scaleNanos} from \"./scaling\";\nimport {redactCell} from \"./redact\";\n\nexport function heading5Icon(icon, text) {\n    let h5 = document.createElement(\"h5\");\n    h5.innerHTML = \"<i class='fa fa-\" + icon + \"'></i> \" + text;\n    return h5;\n}\n\nexport function theading(text, colspan=0, tooltip=\"\", id=\"\") {\n    let th = document.createElement(\"th\");\n    th.classList.add(\"text-center\");\n    if (id !== \"\") th.id = id;\n    if (colspan > 0) th.colSpan = colspan;\n\n    if (tooltip !== \"\") {\n        th.setAttribute(\"data-bs-toggle\", \"tooltip\");\n        th.setAttribute(\"data-bs-placement\", \"top\");\n        th.setAttribute(\"data-bs-html\", \"true\");\n        th.setAttribute(\"title\", tooltip);\n        th.innerHTML = text + \" <i class='fas fa-info-circle'></i>\";\n    } else {\n        th.innerText = text;\n    }\n\n    return th;\n}\n\nexport function simpleRow(text, redact=false) {\n    let td = document.createElement(\"td\");\n    if (redact) {\n        td.classList.add(\"redactable\");\n    }\n    td.innerText = text;\n    return td;\n}\n\nexport function simpleRowHtml(text) {\n    let td = document.createElement(\"td\");\n    td.innerHTML = text;\n    return td;\n}\n\nexport function clearDashDiv(id, target) {\n    let limit = 1;\n    if (id.includes(\"___\")) limit = 0;\n    while (target.children.length > limit) {\n        target.removeChild(target.lastChild);\n    }\n}\n\nexport function clearDiv(target, targetLength=0) {\n    while (target.children.length > targetLength) {\n        target.removeChild(target.lastChild);\n    }\n}\n\nexport function enableTooltips() {\n    // Tooltips everywhere!\n    let tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle=\"tooltip\"]'))\n    let tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {\n        return new bootstrap.Tooltip(tooltipTriggerEl)\n    })\n}\n\nlet pendingTooltips = [];\n\nexport function tooltipsNextFrame(id) {\n    pendingTooltips.push(id);\n    requestAnimationFrame(() => {\n        setTimeout(() => {\n            pendingTooltips.forEach((id) => {\n                let tooltipTriggerEl = document.getElementById(id);\n                if (tooltipTriggerEl !== null) {\n                    new bootstrap.Tooltip(tooltipTriggerEl);\n                }\n            });\n            pendingTooltips = [];\n        })\n    });\n}\n\nexport function clientTableHeader() {\n    let thead = document.createElement(\"thead\");\n    thead.appendChild(theading(\"Circuit\"));\n    thead.appendChild(theading(\"Device\"));\n    thead.appendChild(theading(\"Plan (Mbps)\"));\n    thead.appendChild(theading(\"Parent\"));\n    thead.appendChild(theading(\"IP\"));\n    thead.appendChild(theading(\"Last Seen\"));\n    thead.appendChild(theading(\"Throughput\", 2));\n    thead.appendChild(theading(\"RTT\", 2));\n    thead.appendChild(theading(\"Re-Xmit\", 2));\n    return thead;\n}\n\nexport function formatLastSeen(n) {\n    let fiveMinutesInNanos = 300000000000;\n    let result = \"-\";\n    if (n > fiveMinutesInNanos) {\n        result = \"> 5 Minutes ago\";\n    } else {\n        result = scaleNanos(n, 0) + \" ago\";\n    }\n    return result;\n}\n\nexport function topNTableHeader() {\n    let th = document.createElement(\"thead\");\n    th.classList.add(\"small\");\n    th.appendChild(theading(\"IP Address/Circuit\"));\n    th.appendChild(theading(\"Plan\"));\n    th.appendChild(theading(\"DL \u2B07\uFE0F\"));\n    th.appendChild(theading(\"UL \u2B06\uFE0F\"));\n    th.appendChild(theading(\"RTT (ms)\"));\n    th.appendChild(theading(\"TCP Retransmits\", 2));\n    return th;\n}\n\nexport function topNTableRow(r) {\n    let row = document.createElement(\"tr\");\n    row.classList.add(\"small\");\n\n    if (r.circuit_id !== \"\") {\n        let td = document.createElement(\"td\");\n        let link = document.createElement(\"a\");\n        link.href = \"circuit.html?id=\" + encodeURI(r.circuit_id);\n        link.innerText = r.ip_address;\n        redactCell(link);\n        td.append(link);\n        row.append(td);\n    } else {\n        let ip = document.createElement(\"td\");\n        ip.innerText = r.ip_address;\n        redactCell(ip);\n        row.append(ip);\n    }\n\n    let shaped = document.createElement(\"td\");\n    shaped.innerText = r.plan.down + \" / \" + r.plan.up;\n    row.append(shaped);\n\n    let dl = document.createElement(\"td\");\n    dl.innerHTML = formatThroughput(r.bits_per_second.down, r.plan.down);\n    row.append(dl);\n\n    let ul = document.createElement(\"td\");\n    ul.innerHTML = formatThroughput(r.bits_per_second.up, r.plan.up);\n    row.append(ul);\n\n    let rtt = document.createElement(\"td\");\n    rtt.innerHTML = formatRtt(r.median_tcp_rtt);\n    row.append(rtt);\n\n    let tcp_xmit_down = document.createElement(\"td\");\n    tcp_xmit_down.innerHTML = formatRetransmit(r.tcp_retransmits.down);\n    row.append(tcp_xmit_down);\n\n    let tcp_xmit_up = document.createElement(\"td\");\n    tcp_xmit_up.innerHTML = formatRetransmit(r.tcp_retransmits.up);\n    row.append(tcp_xmit_up);\n\n    return row;\n}\n\nexport function TopNTableFromMsgData(msg) {\n    let t = document.createElement(\"table\");\n    t.classList.add(\"table-sm\", \"dash-table\");\n\n    t.appendChild(topNTableHeader());\n\n    let tbody = document.createElement(\"tbody\");\n    msg.data.forEach((r) => {\n        t.appendChild(topNTableRow(r));\n    });\n    t.appendChild(tbody);\n    return t;\n}", "import {clearDiv, formatLastSeen, simpleRow, theading} from \"./helpers/builders\";\nimport {scaleNumber} from \"./helpers/scaling\";\n\nlet button = document.getElementById(\"btnCsv\");\nbutton.onclick = () => {\n   window.location.href = \"/local-api/unknownIpsCsv\";\n};\n\n$.get(\"/local-api/unknownIps\", (data) => {\n   let target = document.getElementById(\"unknown\");\n   let table = document.createElement(\"table\");\n   table.classList.add(\"table\", \"table-striped\");\n   let thead = document.createElement(\"thead\");\n   thead.appendChild(theading(\"IP Address\"));\n   thead.appendChild(theading(\"Last Seen\"));\n   thead.appendChild(theading(\"Total Bytes\", 2));\n   table.appendChild(thead);\n   let tbody = document.createElement(\"tbody\");\n\n   data.forEach((row) => {\n      let tr = document.createElement(\"tr\");\n      tr.appendChild(simpleRow(row.ip));\n      tr.appendChild(simpleRow(formatLastSeen(row.last_seen_nanos)));\n      tr.appendChild(simpleRow(scaleNumber(row.total_bytes.down)));\n      tr.appendChild(simpleRow(scaleNumber(row.total_bytes.up)));\n      tbody.appendChild(tr);\n   });\n\n   table.appendChild(tbody);\n   clearDiv(target);\n   target.appendChild(table);\n\n   //console.log(data);\n});"],
  "mappings": "MAAO,SAASA,EAAYC,EAAGC,EAAM,EAAG,CACpC,OAAID,EAAI,MACIA,EAAI,MAAe,QAAQC,CAAK,EAAI,IACrCD,EAAI,KACHA,EAAI,KAAY,QAAQC,CAAK,EAAI,IAClCD,EAAI,KACHA,EAAI,KAAS,QAAQC,CAAK,EAAI,IAC/BD,EAAI,KACHA,EAAI,KAAM,QAAQC,CAAK,EAAI,IAEhCD,CACX,CAEO,SAASE,EAAWF,EAAGG,EAAU,EAAG,CACvC,OAAIH,IAAM,EAAU,IAChBA,EAAI,MACIA,EAAI,MAAa,QAAQG,CAAS,EAAI,IACxCH,EAAI,KACFA,EAAI,KAAY,QAAQG,CAAS,EAAI,IACtCH,EAAI,KACHA,EAAI,KAAS,QAAQG,CAAS,EAAI,KACnCH,EAAI,KACHA,EAAI,KAAM,QAAQG,CAAS,EAAI,QAEpCH,EAAI,IACf,CChBO,SAASI,EAASC,EAAMC,EAAQ,EAAGC,EAAQ,GAAIC,EAAG,GAAI,CACzD,IAAIC,EAAK,SAAS,cAAc,IAAI,EACpC,OAAAA,EAAG,UAAU,IAAI,aAAa,EAC1BD,IAAO,KAAIC,EAAG,GAAKD,GACnBF,EAAU,IAAGG,EAAG,QAAUH,GAE1BC,IAAY,IACZE,EAAG,aAAa,iBAAkB,SAAS,EAC3CA,EAAG,aAAa,oBAAqB,KAAK,EAC1CA,EAAG,aAAa,eAAgB,MAAM,EACtCA,EAAG,aAAa,QAASF,CAAO,EAChCE,EAAG,UAAYJ,EAAO,uCAEtBI,EAAG,UAAYJ,EAGZI,CACX,CAEO,SAASC,EAAUL,EAAMM,EAAO,GAAO,CAC1C,IAAIC,EAAK,SAAS,cAAc,IAAI,EACpC,OAAID,GACAC,EAAG,UAAU,IAAI,YAAY,EAEjCA,EAAG,UAAYP,EACRO,CACX,CAgBO,SAASC,EAASC,EAAQC,EAAa,EAAG,CAC7C,KAAOD,EAAO,SAAS,OAASC,GAC5BD,EAAO,YAAYA,EAAO,SAAS,CAE3C,CAyCO,SAASE,EAAeC,EAAG,CAC9B,IAAIC,EAAqB,KACrBC,EAAS,IACb,OAAIF,EAAIC,EACJC,EAAS,kBAETA,EAASC,EAAWH,EAAG,CAAC,EAAI,OAEzBE,CACX,CCtGA,IAAIE,EAAS,SAAS,eAAe,QAAQ,EAC7CA,EAAO,QAAU,IAAM,CACpB,OAAO,SAAS,KAAO,0BAC1B,EAEA,EAAE,IAAI,wBAA0BC,GAAS,CACtC,IAAIC,EAAS,SAAS,eAAe,SAAS,EAC1CC,EAAQ,SAAS,cAAc,OAAO,EAC1CA,EAAM,UAAU,IAAI,QAAS,eAAe,EAC5C,IAAIC,EAAQ,SAAS,cAAc,OAAO,EAC1CA,EAAM,YAAYC,EAAS,YAAY,CAAC,EACxCD,EAAM,YAAYC,EAAS,WAAW,CAAC,EACvCD,EAAM,YAAYC,EAAS,cAAe,CAAC,CAAC,EAC5CF,EAAM,YAAYC,CAAK,EACvB,IAAIE,EAAQ,SAAS,cAAc,OAAO,EAE1CL,EAAK,QAASM,GAAQ,CACnB,IAAIC,EAAK,SAAS,cAAc,IAAI,EACpCA,EAAG,YAAYC,EAAUF,EAAI,EAAE,CAAC,EAChCC,EAAG,YAAYC,EAAUC,EAAeH,EAAI,eAAe,CAAC,CAAC,EAC7DC,EAAG,YAAYC,EAAUE,EAAYJ,EAAI,YAAY,IAAI,CAAC,CAAC,EAC3DC,EAAG,YAAYC,EAAUE,EAAYJ,EAAI,YAAY,EAAE,CAAC,CAAC,EACzDD,EAAM,YAAYE,CAAE,CACvB,CAAC,EAEDL,EAAM,YAAYG,CAAK,EACvBM,EAASV,CAAM,EACfA,EAAO,YAAYC,CAAK,CAG3B,CAAC",
  "names": ["scaleNumber", "n", "fixed", "scaleNanos", "precision", "theading", "text", "colspan", "tooltip", "id", "th", "simpleRow", "redact", "td", "clearDiv", "target", "targetLength", "formatLastSeen", "n", "fiveMinutesInNanos", "result", "scaleNanos", "button", "data", "target", "table", "thead", "theading", "tbody", "row", "tr", "simpleRow", "formatLastSeen", "scaleNumber", "clearDiv"]
}
